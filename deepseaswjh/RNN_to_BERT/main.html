<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
   "http://www.w3.org/TR/html4/strict.dtd">
<HTML>
   <HEAD>
      <TITLE>My first HTML document</TITLE>
      <style rel="stylesheet" type="text/css">
body {
 font-size: 20px;
 
 margin-top: 50px;
    margin-bottom: 50px;
    margin-right: 80px;
    margin-left: 100px;
    
    padding-top: 50px;
    padding-bottom: 50px;
    padding-right: 80px;
    padding-left: 80px;
    
    line-height:35px;
}
img {
 width:900px;
}
</style>
      <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    "HTML-CSS" : {
        availableFonts : ["STIX"],
        preferredFont : "STIX",
        webFont : "STIX-Web",
        imageFont : null
    }
});
</script>
     <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js" type="text/javascript">    
    MathJax.Hub.Config({
        HTML: ["input/TeX","output/HTML-CSS"],
        TeX: { extensions: ["AMSmath.js","AMSsymbols.js"], 
               equationNumbers: { autoNumber: "AMS" } },
        extensions: ["tex2jax.js"],
        jax: ["input/TeX","output/HTML-CSS"],
        tex2jax: { inlineMath: [ ['$$$','$$$'] ],
                   displayMath: [ ['$$$$','$$$$'] ],
                   processEscapes: true },
        "HTML-CSS": { availableFonts: ["TeX"],
                      linebreaks: { automatic: true } }
    });
</script>
   </HEAD>
   <BODY>
<xmp>
https://www.slideshare.net/deepseaswjh/rnn-bert

================================================================================
RNN

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_11:49:34.png' alt=''><xmp>

- $$$x_0, x_1, x_2, \cdots$$$: input tokens like I, go, to, ...
- 2 arrows from cells which are marked by "A": outputs

- Meaning
- Output from previous cell affect the training continuously


================================================================================
There are 2 trainable weights; W (for recurrent layers) and U (for input layers)

https://medium.com/deep-math-machine-learning-ai/chapter-10-deepnlp-recurrent-neural-networks-with-math-c4a6846a50a2

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_11:54:10.png' alt=''><xmp>

================================================================================
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_11:55:30.png' alt=''><xmp>

$$$a^{(t)} = b+W h^{(t-1)} + Ux^{(t)}$$$
$$$a^{(t)}$$$: output at time t
$$$b$$$: bias
$$$W$$$: trainable parameter for recurrent layers
$$$h^{(t-1)}$$$: output from previous cell
$$$x^{(t)}$$$: input data at time t
$$$U$$$: trainable parameter for input layers

$$$h^{(t)}=tanh(a^{(t)})$$$
$$$tanh()$$$: activation function
$$$h^{(t)}$$$: output from the cells

$$$o^{(t)}=c+Vh^{(t)}$$$
$$$o^{(t)}$$$: output in the last output layer

$$$y^{(t)}=softmax(o^{(t)})$$$: output in the last output layer after softmax

================================================================================
Various RNN structures

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:01:42.png' alt=''><xmp>

- Red: input structure
- Green: hidden structure
- Blue: output structure

================================================================================
LSTM (Long Shot Term Momory)

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:02:59.png' alt=''><xmp>

- Intensity of data becomes vague as training goes

================================================================================
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:03:33.png' alt=''><xmp>

LSTM memorizes "important data" up to the end of training

================================================================================
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:04:18.png' alt=''><xmp>

- LSTM means "specially designed RNN cell"
- LSTM has 8 trainable parameters (4 for recurrent layers + 4 for input layers)

================================================================================
Weakness of RNN

- RNN considers only "previous status" + "current status"
- RNN doesn't consider "entire context" in the training

================================================================================
Seq2Seq to overcome weakness of RNN

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:06:40.png' alt=''><xmp>

- Seq2Seq = Encoder_LSTM + Decoder_LSTM

================================================================================
Structure of Seq2Seq

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:07:37.png' alt=''><xmp>

- Step1: process "input sentence" by encoder, creating "feature vector"
- Step2: process "feature vector" by decoder, creating "output sentence"

================================================================================
Weakness of LSTM driven Seq2Seq

- It's lack of capability with only "gates" which adjust the flow of information
- "Gates": "removing gate", "input gate", "output gate"
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:11:08.png' alt=''><xmp>

- Due to above limitation of gates,
if input sentence becomes longer, LSTM-Seq2Seq becomes confused

================================================================================
Attention

Attention module focuses on important part from the sentence
"Important part" is directly passed to "decoder"

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:13:20.png' alt=''><xmp>

================================================================================
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:14:01.png' alt=''><xmp>

- When decorder creates output words,
"attention layer" decides what information "decoder" should take

================================================================================
Transformer

- LSTM is not used
- Attention module consisits of "Encoder-Decoder" model

================================================================================
Transformer does "self-attention"

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:18:44.png' alt=''><xmp>

================================================================================
How "transformer" does the "self-attention"?

- Use Scaled Dot-Product Attention module
  - Each word is converted into Q,K,V
  - Perform: (each word $$$Q$$$) $$$\cdot$$$ (other word $$$K$$$)
  - SoftMax: select important word which transformer will pay attention to
  - (import word vector after softmaxt) $$$\cdot$$$ (original word information $$$V$$$)

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:25:24.png' alt=''><xmp>

================================================================================
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:26:00.png' alt=''><xmp>

- Illustration of how "Scaled Dot-Product Attention module" works

- Input: 2 words
- Embedding: feature vector from 2 words
- Create Q,K,V vector from 2 feature vectors
- Score: $$$Q \cdot K$$$
- Divide by 8: maybe "Scale module"
- Softmax: 2 softmaxed-numbers from 2 word
It turns out "Thinking" is important word and transformer will pay attention to "Thinking"

================================================================================
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:30:26.png' alt=''><xmp>

================================================================================
Encoder and Decoder structure in Transformer

- Multiple encoders
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:30:59.png' alt=''><xmp>

- Multiple decoders
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:31:26.png' alt=''><xmp>

- Fully connected layer and Softmax layer
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:31:51.png' alt=''><xmp>

- Entire view
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:32:05.png' alt=''><xmp>

================================================================================
BERT (Bidirectional Encoder Representations from Transformers)

- Deep learning language model which uses pretraining to have general language understanding

- BERT is composed of transformers

================================================================================
Transfer learning (or fine tuning)

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:36:34.png' alt=''><xmp>

- Dataset: ImageNet
- Randomly initialized weight in the neural network
- Trainable parameters in the network is trained 
by using ImageNet dataset which has 100 classes
- Save trained parameter into the file
- Prepare new data which has more classes
- Append new layer which has more output classes
- Load trained parameter and fill the loaded parameter values into network
- Perform training step over new dataset

================================================================================
Tranfer learning NLP models in 2018
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:40:50.png' alt=''><xmp>

================================================================================
Structure of BERT

- Use only "encoder network" from "transformer"
- BERT Base: 12 number of tranformer blocks
- BERT Large: 24 number of tranformer blocks

================================================================================
Pretrain BERT to give general language understanding to the BERT

Dataset
- BooksCorpus: 800 million of words
- Wikipedia: 2500 million of words

================================================================================
How to pretrain BERT network?

Method1: mask some words

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:46:32.png' alt=''><xmp>

* Details
- Input sentence with special tokens like CLS, SEP
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:47:24.png' alt=''><xmp>

- Randomly mask 15% of words of the input sentence
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:48:22.png' alt=''><xmp>
- improvisation is replaced with "MASK" token
- Max length of input data: 512

- Create output vector (512 dimension) from BERT network
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:49:39.png' alt=''><xmp>

- Pass output vector into FFNN+Softmax layer 
to create probability values (2500 million number of probability values)
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:50:06.png' alt=''><xmp>

- Following stands for all English words (like 2500 million)
from Aardvark to Zyzzyva
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:52:03.png' alt=''><xmp>

- masked word has high probability value
and it means BERT model could predict "masked word" correctly,
and it means BERT mdoel could understand general language model

================================================================================
How to pretrain BERT network?

Method2: predict next sentence

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_12:57:02.png' alt=''><xmp>

* Details

- Input data: 2 sentences (sentence A + sentence B)
Input data has CLS (starting position), MASK (masked words), SEP (separation to the 2 sentences) tokens

- Perform tokenization on the input sentence
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:05:31.png' alt=''><xmp>
- Max length of input sentence is 512

- Use BERT network
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:06:14.png' alt=''><xmp>
- Get output vector (512 dimension)

- Pass output vector into FFNN+Softmax layer
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:07:07.png' alt=''><xmp>

- Given 2 sentence is "continous sentence"?
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:07:54.png' alt=''><xmp>

================================================================================
Embedding input data for BERT

Embedding_for_BERT = token_embedding + segment_embedding + position_embedding

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:09:58.png' alt=''><xmp>

* Details
- Raw input data before "BERT embedding"
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:10:34.png' alt=''><xmp>
- CLS: starting position, or class
- SEP: to separate 2 sentence

- Apply "token embedding" into input data
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:12:02.png' alt=''><xmp>

- Apply "segment embedding"
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:13:05.png' alt=''><xmp>

- Apply "position embedding"
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:13:23.png' alt=''><xmp>

================================================================================
Use transfer learning on pretrained BERT network

- Classify 2 sentences
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:19:01.png' alt=''><xmp>

- CLS: token
- Sentence1
- SEP: token
- Sentence2
- Preprocess input data
- Pass input data into BERT network
- Get class from C

================================================================================
- Q and A model

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:20:58.png' alt=''><xmp>

- CLS: token
- Sentence as question
- SEP: token
- Sentence as answer paragraph
- Preprocess input data
- Pass input data into BERT network

================================================================================
- Classify "one given sentence"

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:22:17.png' alt=''><xmp>

================================================================================
- POS tagging on single sentence

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:22:51.png' alt=''><xmp>

================================================================================
SQuAD: Standford Question Answering Dataset

Given paragraph
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:24:31.png' alt=''><xmp>

Question
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:24:53.png' alt=''><xmp>

Ground truth answer which BERT should make
</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:25:27.png' alt=''><xmp>

================================================================================
BERT words well than other models

</xmp><img src='https://raw.githubusercontent.com/youngminpark2559/nlp/master/deepseaswjh/RNN_to_BERT/pics/2019_05_17_13:26:15.png' alt=''><xmp>

================================================================================

</xmp>
   </BODY>
</HTML>
